/* =========================================
   FORGE PIPELINE STEPS GRID
   Grille d'étapes inspirée du tracker d'activité
   Avec animations GPU-optimisées
   ========================================= */

@import './forge-pipeline-variables.css';

/* ==========================================
   STEPS GRID CONTAINER
   ========================================== */

.forge-steps-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: var(--space-3);
  width: 100%;
  margin-bottom: var(--space-5);
  transform: var(--gpu-transform);
  contain: layout style;
}

/* Responsive adjustments */
@media (max-width: 640px) {
  .forge-steps-grid {
    gap: var(--space-2);
  }
}

/* ==========================================
   INDIVIDUAL STEP ITEM
   ========================================== */

.forge-step-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-2);
  transform: var(--gpu-transform);
  transition: transform var(--anim-duration-fast) var(--anim-ease-smooth);
  will-change: transform;
  contain: layout style paint;
}

.forge-step-item--active {
  animation: forgePulseGlow 2s var(--anim-ease-smooth) infinite;
}

/* Hover effect for active steps */
@media (hover: hover) {
  .forge-step-item--active:hover {
    transform: scale(1.05) translateZ(0);
  }
}

/* ==========================================
   STEP ICON CONTAINER
   ========================================== */

.forge-step-icon-box {
  position: relative;
  width: 3rem;
  height: 3rem;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-2xl);
  backdrop-filter: blur(var(--glass-blur-light)) saturate(var(--glass-saturate-light));
  -webkit-backdrop-filter: blur(var(--glass-blur-light)) saturate(var(--glass-saturate-light));
  transform: var(--gpu-transform);
  transition: all var(--anim-duration-base) var(--anim-ease-smooth);
  will-change: transform, box-shadow, border-color;
  contain: layout style paint;
}

/* Completed state */
.forge-step-icon-box--completed {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(34, 197, 94, 0.1));
  border: 2px solid rgba(34, 197, 94, 0.6);
  box-shadow: 0 4px 16px rgba(34, 197, 94, 0.3),
              inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

/* Active state - Energy */
.forge-step-icon-box--active.forge-step-icon-box--energy {
  background: radial-gradient(circle at 30% 30%, color-mix(in srgb, var(--forge-energy-primary) 35%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 70%, color-mix(in srgb, var(--forge-energy-secondary) 25%, transparent) 0%, transparent 50%),
              rgba(255, 255, 255, 0.12);
  border: 2px solid color-mix(in srgb, var(--forge-energy-primary) 60%, transparent);
  box-shadow: var(--shadow-energy-md),
              0 0 40px color-mix(in srgb, var(--forge-energy-secondary) 25%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.2),
              inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

/* Active state - Body */
.forge-step-icon-box--active.forge-step-icon-box--body {
  background: radial-gradient(circle at 30% 30%, color-mix(in srgb, var(--forge-body-primary) 35%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 70%, color-mix(in srgb, var(--forge-body-secondary) 25%, transparent) 0%, transparent 50%),
              rgba(255, 255, 255, 0.12);
  border: 2px solid color-mix(in srgb, var(--forge-body-primary) 60%, transparent);
  box-shadow: var(--shadow-body-md),
              0 0 40px color-mix(in srgb, var(--forge-body-secondary) 25%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.2),
              inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

/* Active state - Face */
.forge-step-icon-box--active.forge-step-icon-box--face {
  background: radial-gradient(circle at 30% 30%, color-mix(in srgb, var(--forge-face-primary) 35%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 70%, color-mix(in srgb, var(--forge-face-secondary) 25%, transparent) 0%, transparent 50%),
              rgba(255, 255, 255, 0.12);
  border: 2px solid color-mix(in srgb, var(--forge-face-primary) 60%, transparent);
  box-shadow: var(--shadow-face-md),
              0 0 40px color-mix(in srgb, var(--forge-face-secondary) 25%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.2),
              inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

/* Pending/Inactive state */
.forge-step-icon-box--pending {
  background: rgba(255, 255, 255, 0.06);
  border: 2px solid rgba(255, 255, 255, 0.15);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2),
              inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

/* Responsive sizing */
@media (min-width: 768px) {
  .forge-step-icon-box {
    width: 4rem;
    height: 4rem;
  }
}

/* ==========================================
   PULSING RING FOR ACTIVE STEP
   ========================================== */

.forge-step-pulse-ring {
  position: absolute;
  inset: 0;
  border-radius: var(--radius-2xl);
  pointer-events: none;
  animation: forgePulseRing 2s var(--anim-ease-smooth) infinite;
  will-change: transform, opacity;
}

.forge-step-pulse-ring--energy {
  border: 2px solid var(--forge-energy-primary);
  box-shadow: 0 0 20px color-mix(in srgb, var(--forge-energy-primary) 50%, transparent);
}

.forge-step-pulse-ring--body {
  border: 2px solid var(--forge-body-primary);
  box-shadow: 0 0 20px color-mix(in srgb, var(--forge-body-primary) 50%, transparent);
}

.forge-step-pulse-ring--face {
  border: 2px solid var(--forge-face-primary);
  box-shadow: 0 0 20px color-mix(in srgb, var(--forge-face-primary) 50%, transparent);
}

/* ==========================================
   STEP LABEL
   ========================================== */

.forge-step-label {
  font-size: var(--text-xs);
  font-weight: var(--font-medium);
  text-align: center;
  line-height: 1.2;
  transition: color var(--anim-duration-base) var(--anim-ease-smooth),
              text-shadow var(--anim-duration-base) var(--anim-ease-smooth);
  will-change: color;
}

/* Completed state */
.forge-step-label--completed {
  color: #22C55E;
}

/* Active state - Energy */
.forge-step-label--active.forge-step-label--energy {
  color: var(--forge-energy-primary);
  text-shadow: 0 0 12px color-mix(in srgb, var(--forge-energy-primary) 50%, transparent);
}

/* Active state - Body */
.forge-step-label--active.forge-step-label--body {
  color: var(--forge-body-primary);
  text-shadow: 0 0 12px color-mix(in srgb, var(--forge-body-primary) 50%, transparent);
}

/* Active state - Face */
.forge-step-label--active.forge-step-label--face {
  color: var(--forge-face-primary);
  text-shadow: 0 0 12px color-mix(in srgb, var(--forge-face-primary) 50%, transparent);
}

/* Pending state */
.forge-step-label--pending {
  color: rgba(255, 255, 255, 0.5);
}

/* Responsive sizing */
@media (min-width: 768px) {
  .forge-step-label {
    font-size: var(--text-sm);
  }
}

/* ==========================================
   DYNAMIC MESSAGE SECTION
   ========================================== */

.forge-message-section {
  margin-top: var(--space-4);
  padding: var(--space-4);
  border-radius: var(--radius-2xl);
  backdrop-filter: blur(var(--glass-blur-medium)) saturate(var(--glass-saturate-medium));
  -webkit-backdrop-filter: blur(var(--glass-blur-medium)) saturate(var(--glass-saturate-medium));
  animation: forgeSlideInUp var(--anim-duration-base) var(--anim-ease-smooth);
  transform: var(--gpu-transform);
  contain: layout style paint;
}

/* Energy theme */
.forge-message-section--energy {
  background: radial-gradient(circle at 50% 20%, color-mix(in srgb, var(--forge-energy-primary) 18%, transparent) 0%, transparent 65%),
              rgba(255, 255, 255, 0.08);
  border: 2px solid color-mix(in srgb, var(--forge-energy-primary) 30%, rgba(255, 255, 255, 0.15));
  box-shadow: var(--shadow-md),
              0 0 40px color-mix(in srgb, var(--forge-energy-primary) 18%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

/* Body theme */
.forge-message-section--body {
  background: radial-gradient(circle at 50% 20%, color-mix(in srgb, var(--forge-body-primary) 18%, transparent) 0%, transparent 65%),
              rgba(255, 255, 255, 0.08);
  border: 2px solid color-mix(in srgb, var(--forge-body-primary) 30%, rgba(255, 255, 255, 0.15));
  box-shadow: var(--shadow-md),
              0 0 40px color-mix(in srgb, var(--forge-body-primary) 18%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

/* Face theme */
.forge-message-section--face {
  background: radial-gradient(circle at 50% 20%, color-mix(in srgb, var(--forge-face-primary) 18%, transparent) 0%, transparent 65%),
              rgba(255, 255, 255, 0.08);
  border: 2px solid color-mix(in srgb, var(--forge-face-primary) 30%, rgba(255, 255, 255, 0.15));
  box-shadow: var(--shadow-md),
              0 0 40px color-mix(in srgb, var(--forge-face-primary) 18%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

/* Message content */
.forge-message-content {
  text-align: center;
}

.forge-message-title {
  font-size: var(--text-base);
  font-weight: var(--font-bold);
  margin-bottom: var(--space-1);
}

/* Energy theme */
.forge-message-title--energy {
  color: var(--forge-energy-primary);
  text-shadow: 0 0 20px color-mix(in srgb, var(--forge-energy-primary) 40%, transparent);
}

/* Body theme */
.forge-message-title--body {
  color: var(--forge-body-primary);
  text-shadow: 0 0 20px color-mix(in srgb, var(--forge-body-primary) 40%, transparent);
}

/* Face theme */
.forge-message-title--face {
  color: var(--forge-face-primary);
  text-shadow: 0 0 20px color-mix(in srgb, var(--forge-face-primary) 40%, transparent);
}

.forge-message-subtitle {
  font-size: var(--text-sm);
  color: rgba(255, 255, 255, 0.7);
}

/* Energy theme */
.forge-message-subtitle--energy {
  color: color-mix(in srgb, #E5E7EB 80%, var(--forge-energy-primary) 20%);
}

/* Body theme */
.forge-message-subtitle--body {
  color: color-mix(in srgb, #E5E7EB 80%, var(--forge-body-primary) 20%);
}

/* Face theme */
.forge-message-subtitle--face {
  color: color-mix(in srgb, #E5E7EB 80%, var(--forge-face-primary) 20%);
}

/* Responsive sizing */
@media (min-width: 768px) {
  .forge-message-title {
    font-size: var(--text-lg);
  }
}

/* ==========================================
   MOBILE OPTIMIZATIONS
   ========================================== */

@media (max-width: 768px) {
  /* Disable shimmer and complex effects on mobile */
  .forge-step-icon-box--active::after {
    display: none !important;
  }

  /* Simplify hover states */
  .forge-step-item--active:hover {
    transform: translateZ(0) !important;
  }

  /* Reduce pulse intensity */
  .forge-step-pulse-ring {
    animation-duration: 3s;
    opacity: 0.6;
  }

  /* Disable animations on low-end mobile */
  .perf-low .forge-step-pulse-ring {
    display: none !important;
  }
}

/* ==========================================
   PERFORMANCE MODES
   ========================================== */

/* Low performance mode */
.perf-low .forge-step-pulse-ring,
.perf-low .forge-step-icon-box--active::before {
  display: none !important;
}

.perf-low .forge-step-icon-box {
  transition: none !important;
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .forge-step-item,
  .forge-step-icon-box,
  .forge-step-label {
    animation: none !important;
    transition-duration: 0.01ms !important;
  }

  .forge-step-pulse-ring {
    display: none !important;
  }

  .forge-step-item--active:hover {
    transform: none !important;
  }
}
