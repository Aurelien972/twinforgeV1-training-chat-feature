/* =========================================
   FRIDGE SCAN ANIMATIONS - VisionOS 26+ TwinForge
   Animations spécialisées pour l'Atelier de Recettes
   ========================================= */

/* =========================================
   KEYFRAMES POUR L'ANALYSE DE FRIGO
   ========================================= */

@keyframes fridge-scan-analysis {
  0% { 
    transform: translateX(-100%) translateZ(0); 
    opacity: 0;
  }
  10%, 90% { 
    opacity: var(--scan-line-opacity, 0.8); 
  }
  100% { 
    transform: translateX(calc(100vw + 100%)) translateZ(0); 
    opacity: 0;
  }
}

@keyframes fridge-grid-pulse {
  0%, 100% { 
    opacity: 0.15; 
    transform: scale(1) translateZ(0);
  }
  50% { 
    opacity: 0.35; 
    transform: scale(1.02) translateZ(0);
  }
}

@keyframes fridge-data-particle {
  0% { 
    transform: translateY(0) rotate(0deg) scale(0) translateZ(0);
    opacity: 0;
  }
  10% { 
    opacity: 1;
    transform: translateY(-10px) rotate(45deg) scale(1) translateZ(0);
  }
  90% { 
    opacity: 1;
    transform: translateY(-80px) rotate(315deg) scale(1.2) translateZ(0);
  }
  100% { 
    transform: translateY(-100px) rotate(360deg) scale(0) translateZ(0);
    opacity: 0;
  }
}

@keyframes fridge-ai-focus {
  0%, 100% { 
    opacity: 0.6;
    transform: scale(1) translateZ(0);
    box-shadow: 0 0 30px color-mix(in srgb, var(--color-fridge-primary) 50%, transparent);
  }
  50% { 
    opacity: 1;
    transform: scale(1.05) translateZ(0);
    box-shadow: 0 0 50px color-mix(in srgb, var(--color-fridge-primary) 80%, transparent);
  }
}

@keyframes fridge-ingredient-detection {
  0% { 
    transform: scale(0.8) translateZ(0);
    opacity: 0;
    filter: blur(4px);
  }
  50% { 
    transform: scale(1.1) translateZ(0);
    opacity: 0.8;
    filter: blur(0px);
  }
  100% { 
    transform: scale(1) translateZ(0);
    opacity: 1;
    filter: blur(0px);
  }
}

@keyframes fridge-recipe-generation {
  0% { 
    transform: translateY(20px) scale(0.9) translateZ(0);
    opacity: 0;
  }
  30% { 
    transform: translateY(-5px) scale(1.02) translateZ(0);
    opacity: 0.8;
  }
  100% { 
    transform: translateY(0) scale(1) translateZ(0);
    opacity: 1;
  }
}

@keyframes fridge-spatial-shimmer {
  0% { 
    transform: translateX(-100%) translateZ(0);
    opacity: 0;
  }
  50% { 
    transform: translateX(0%) translateZ(0);
    opacity: 1;
  }
  100% { 
    transform: translateX(100%) translateZ(0);
    opacity: 0;
  }
}

@keyframes fridge-glow-pulse {
  0%, 100% { 
    opacity: 0.6;
    transform: scale(1.2) translateZ(0);
    box-shadow: 
      0 0 40px color-mix(in srgb, var(--color-fridge-primary) 60%, transparent),
      0 0 80px color-mix(in srgb, var(--color-fridge-primary) 40%, transparent);
  }
  50% { 
    opacity: 0.9;
    transform: scale(1.4) translateZ(0);
    box-shadow: 
      0 0 60px color-mix(in srgb, var(--color-fridge-primary) 80%, transparent),
      0 0 120px color-mix(in srgb, var(--color-fridge-primary) 60%, transparent),
      0 0 180px color-mix(in srgb, var(--color-plasma-cyan) 40%, transparent);
  }
}

/* =========================================
   CLASSES D'ANIMATION POUR L'ATELIER
   ========================================= */

.fridge-scan-analysis-line {
  animation: fridge-scan-analysis var(--analysis-scan-speed, 3s) linear infinite;
  transform: translateZ(0);
  will-change: transform, opacity;
  backface-visibility: hidden;
}

.fridge-grid-pulse {
  animation: fridge-grid-pulse var(--analysis-grid-speed, 2.5s) ease-in-out infinite;
  transform: translateZ(0);
  will-change: transform, opacity;
  backface-visibility: hidden;
}

.fridge-data-particle {
  animation: fridge-data-particle var(--analysis-particle-speed, 4s) ease-out infinite;
  transform: translateZ(0);
  will-change: transform, opacity;
  backface-visibility: hidden;
}

.fridge-ai-focus {
  animation: fridge-ai-focus var(--analysis-focus-speed, 3s) ease-in-out infinite;
  transform: translateZ(0);
  will-change: transform, opacity, box-shadow;
  backface-visibility: hidden;
}

.fridge-ingredient-detection {
  animation: fridge-ingredient-detection 0.8s ease-out forwards;
  transform: translateZ(0);
  will-change: transform, opacity, filter;
  backface-visibility: hidden;
}

.fridge-recipe-generation {
  animation: fridge-recipe-generation 0.6s ease-out forwards;
  transform: translateZ(0);
  will-change: transform, opacity;
  backface-visibility: hidden;
}

.fridge-spatial-shimmer {
  animation: fridge-spatial-shimmer 2s ease-in-out infinite;
  transform: translateZ(0);
  will-change: transform, opacity;
  backface-visibility: hidden;
}

.fridge-glow-pulse {
  animation: fridge-glow-pulse var(--animation-duration-slower, 3.2s) ease-in-out infinite;
  transform: translateZ(0);
  will-change: transform, opacity, box-shadow;
  backface-visibility: hidden;
}

/* =========================================
   OPTIMISATIONS MOBILE POUR L'ATELIER
   ========================================= */

@media (max-width: 768px) {
  /* Désactiver seulement certaines animations lourdes sur mobile */
  .fridge-grid-pulse,
  .fridge-glow-pulse {
    animation: none !important;
  }

  /* Réactiver et ralentir les animations essentielles pour la phase d'analyse */
  .fridge-scan-analysis-line {
    animation: fridge-scan-analysis 6s linear infinite !important;
  }

  .fridge-data-particle {
    animation: fridge-data-particle 8s ease-out infinite !important;
  }

  .fridge-ai-focus {
    animation: fridge-ai-focus 6s ease-in-out infinite !important;
  }
  /* États statiques optimisés pour mobile */

  .fridge-grid-pulse {
    opacity: 0.25 !important;
    transform: scale(1.01) translateZ(0) !important;
  }


  .fridge-glow-pulse {
    opacity: 0.8 !important;
    transform: scale(1.3) translateZ(0) !important;
    box-shadow: 
      0 0 50px color-mix(in srgb, var(--color-fridge-primary) 70%, transparent),
      0 0 100px color-mix(in srgb, var(--color-fridge-primary) 50%, transparent) !important;
  }

  /* Garder les animations d'entrée avec durées réduites */
  .fridge-ingredient-detection,
  .fridge-recipe-generation,
  .fridge-spatial-shimmer {
    animation-duration: calc(var(--animation-duration-base, 1s) * 0.7) !important;
  }
}

/* =========================================
   SUPPORT REDUCED MOTION
   ========================================= */

@media (prefers-reduced-motion: reduce) {
  .fridge-scan-analysis-line,
  .fridge-grid-pulse,
  .fridge-data-particle,
  .fridge-ai-focus,
  .fridge-glow-pulse,
  .fridge-spatial-shimmer {
    animation: none !important;
  }

  /* États statiques pour reduced motion */
  .fridge-scan-analysis-line {
    opacity: 0.5 !important;
    transform: translateX(25%) translateZ(0) !important;
  }

  .fridge-grid-pulse {
    opacity: 0.3 !important;
    transform: scale(1.02) translateZ(0) !important;
  }

  .fridge-data-particle {
    opacity: 0.6 !important;
    transform: translateY(-30px) scale(1.1) translateZ(0) !important;
  }

  .fridge-ai-focus {
    opacity: 0.8 !important;
    transform: scale(1.03) translateZ(0) !important;
    box-shadow: 0 0 40px color-mix(in srgb, var(--color-fridge-primary) 60%, transparent) !important;
  }

  .fridge-glow-pulse {
    opacity: 0.7 !important;
    transform: scale(1.25) translateZ(0) !important;
    box-shadow: 
      0 0 45px color-mix(in srgb, var(--color-fridge-primary) 65%, transparent),
      0 0 90px color-mix(in srgb, var(--color-fridge-primary) 45%, transparent) !important;
  }

  /* Garder seulement les animations d'entrée simplifiées */
  .fridge-ingredient-detection,
  .fridge-recipe-generation {
    animation-duration: 0.3s !important;
    animation-iteration-count: 1 !important;
  }
}

/* =========================================
   PERFORMANCE ET CONTAINMENT
   ========================================= */

.fridge-scan-container {
  contain: layout style paint;
  content-visibility: auto;
  contain-intrinsic-size: 600px;
}

.fridge-loading-section {
  contain: layout style paint;
  content-visibility: auto;
  contain-intrinsic-size: 400px;
}

/* GPU acceleration pour tous les éléments d'animation */
.fridge-scan-analysis-line,
.fridge-grid-pulse,
.fridge-data-particle,
.fridge-ai-focus,
.fridge-ingredient-detection,
.fridge-recipe-generation,
.fridge-spatial-shimmer,
.fridge-glow-pulse {
  transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* =========================================
   VARIABLES SPÉCIFIQUES À L'ATELIER
   ========================================= */

:root {
  /* Durées d'animation pour l'Atelier de Recettes */
  --fridge-analysis-duration: 3s;
  --fridge-grid-duration: 2.5s;
  --fridge-particle-duration: 4s;
  --fridge-focus-duration: 3s;
  --fridge-shimmer-duration: 2s;
  
  /* Couleurs spécifiques à l'Atelier */
  --fridge-scan-primary: var(--color-fridge-primary, #EC4899);
  --fridge-scan-secondary: var(--color-fridge-secondary, #F472B6);
  --fridge-scan-accent: var(--color-plasma-cyan, #18E3FF);
  
  /* Opacités pour les effets de scan */
  --fridge-scan-line-opacity: 0.8;
  --fridge-grid-opacity-base: 0.15;
  --fridge-grid-opacity-pulse: 0.35;
  --fridge-particle-opacity: 0.7;
  --fridge-ai-focus-opacity: 0.6;
  --fridge-ai-focus-opacity-peak: 1.0;
}

/* =========================================
   FALLBACKS POUR NAVIGATEURS ANCIENS
   ========================================= */

@supports not (transform: translateZ(0)) {
  .fridge-scan-analysis-line,
  .fridge-grid-pulse,
  .fridge-data-particle,
  .fridge-ai-focus,
  .fridge-ingredient-detection,
  .fridge-recipe-generation,
  .fridge-spatial-shimmer,
  .fridge-glow-pulse {
    transform: none !important;
  }
}

@supports not (backdrop-filter: blur(1px)) {
  .fridge-loading-card {
    background: linear-gradient(145deg, rgba(236, 72, 153, 0.9), rgba(244, 114, 182, 0.8)) !important;
    border: 2px solid rgba(236, 72, 153, 0.6) !important;
  }
}

/* =========================================
   CONTRASTE ÉLEVÉ
   ========================================= */

@media (prefers-contrast: high) {
  .fridge-scan-analysis-line,
  .fridge-data-particle {
    box-shadow: 
      0 0 8px var(--fridge-scan-primary), 
      0 0 16px var(--fridge-scan-primary), 
      0 0 24px var(--fridge-scan-primary) !important;
    opacity: 0.9 !important;
  }
  
  .fridge-grid-pulse {
    background: rgba(236, 72, 153, 0.3) !important;
    border: 1px solid rgba(236, 72, 153, 0.6) !important;
  }
}